
<div style="overflow-x: hidden;overflow-y: scroll;height: 65vh; width: 100%;">

  <div class="container-fluid mt-5">
    <form [formGroup]="orderTransportInfoForm">

      <div>

      <div class="row justify-content-around">

        <div class="form-group col-md-3">
          <label class="font-weight-bold"
            >{{ "Type emballage" | translate }} *</label
          >
          <span
          *ngIf="
            (orderTransportInfoForm.get('packagingType').touched &&
            orderTransportInfoForm.get('packagingType').invalid) ||
            (isFormSubmitted &&
            orderTransportInfoForm.get('packagingType').invalid)
          "
          class="text-lighter"
          style="color: red; font-size: xx-small"
        >
          {{ "Obligatoire" | translate }}
        </span>
          <p-dropdown
          formControlName="packagingType"
            [autoDisplayFirst]="false"
            [options]="packagingTypeList"
            optionLabel="code"

            (onChange)="onSelectPackagingType($event)"
            [filter]="true"
            [showClear]="true"
          ></p-dropdown>
        </div>
        <div class="form-group col-md-3">
          <label class="font-weight-bold"
            >{{ "Poids" | translate }}<span style="font-size: 9px;"> (KG)</span> </label
          >

        <!-- <input
        formControlName="weight"
          type="text"
          class="form-control"
          pInputText
        /> -->
        <p-inputNumber inputId="locale-user" [disabled]="true"  [minFractionDigits]="2" formControlName="weight">
        </p-inputNumber>
        </div>

        <div class="form-group col-md-3">
          <label class="font-weight-bold"
            >{{ "Volume  " | translate }}<span style="font-size: 9px;">Mètre cube (m3)</span> </label
          >
          <p-inputNumber inputId="locale-user" [disabled]="true"
           [minFractionDigits]="2" formControlName="capacity">
          </p-inputNumber>

        </div>
        <div class="form-group col-md-3">
          <label class="font-weight-bold"
          >{{ "Nombre de palette  " | translate }}<span style="font-size: 9px;"></span> </label
        >
        <p-inputNumber  inputId="integeronly" [disabled]="true"
         formControlName="numberOfPallet">
       </p-inputNumber>

        </div>
          </div>
          <div class="row justify-content-around">

          <div class="form-group col-md-6">
            <!-- <p-button  (click)='onShowDialogPackageDetail(null,false)'>Ajouter Details d'emballage</p-button> -->
            <span class="add" style="float: left;" *ngIf="   this.selectedOrderTransportInfo.packagingType?.id>0">
              <img *ngIf="   this.selectedOrderTransportInfo.packagingType?.id==2" src="./assets/img/add.png" style="width: 30px ; height: 30px;">

              <img *ngIf="   this.selectedOrderTransportInfo.packagingType?.id==1
              " src="./assets/img/add_pallet.png" style="width: 30px ; height: 30px;">
              <a (click)='onShowDialogPackageDetail(null,false)' class="ml-2">Ajouter Details d'emballage</a></span>
        </div>
        <div class="form-group col-md-6">
        </div>
        </div>

        <p-table *ngIf="this.selectedOrderTransportInfo.packagingType?.id>0 && packageDetails.length>0"
          [value]=" packageDetails" [lazy]="true" [rows]="5" [paginator]="true"
          [totalRecords]="packageDetails">
            <ng-template pTemplate="header">
              <tr>
                <th>{{ "Nombre colis" | translate }}</th>
                <th>{{ "Type Palette" | translate }}</th>
                <th>{{ "Longueur" | translate }}</th>
                <th>{{ "Largeur" | translate }}</th>
                <th>{{ "Hauteur" | translate }}</th>
                <th>{{ "Poids Kg" | translate }}</th>


                <th style="width: 15%;">{{ "Actions" | translate }}</th>
              </tr>
            </ng-template>
            <ng-template pTemplate="body" let-line>
              <tr>
                <td>{{ line?.numberOfPackages }}</td>

                <td>
                  {{ line?.containerType?.code }}
              </td>
              <td>{{ line?.length }}</td>
              <td>
                  {{ line?.width }}
              </td>
              <td>{{ line?.height }}</td>
              <td>{{ line?.weight }}</td>


                <td>
                  <button

                  type="button"
                  class="btn btn-sm btn-primary mx-1"
                  (click)="onShowDialogPackageDetail(line,true)"
                  >
                  <i class="fa fa-pencil"></i>
                </button>
                <button

                type="button"
                class="btn btn-sm btn-danger mx-1"
                (click)="onDeletePackageDetail(line.id)"
                >
                <i class="fa fa-trash"></i>
              </button>

                </td>
              </tr>
            </ng-template>

          </p-table>
      </div>

      <div class="row justify-content-around mt-3">
  </div>


      <!-- <div class="p-grid" >
        <div class="p-col-12 p-md-6">
          <p-scrollPanel [style]="{ width: '100%', height: 'auto' }">
            <p-panel  [toggleable]="true">
              <ng-template pTemplate = "header" >
                <img src="./assets/img/depuis.png" width="30px"
                height="30px">          <span style="font-weight: 600">DEPUIS</span>
            </ng-template>

              <div class="row justify-content-around">
                <div class="form-group col-md-6">
                  <label class="font-weight-bold">{{
                    "Ville" | translate
                  }} *</label
                  >
                  <span
                  *ngIf="
                    (orderTransportInfoForm.get('orderTransportInfoInitialCity').touched &&
                    orderTransportInfoForm.get('orderTransportInfoInitialCity').invalid) ||
                    (isFormSubmitted &&
                    orderTransportInfoForm.get('orderTransportInfoInitialCity').invalid)
                  "
                  class="text-lighter"
                  style="color: red; font-size: xx-small"
                >
                  {{ "Obligatoire" | translate }}
                </span>
                  <br />

                  <p-autoComplete
                  formControlName="orderTransportInfoInitialCity"
                  [suggestions]="villeList"
                  (onSelect)="onSelectVilleSource($event)"
                  (completeMethod)="onVilleSearch($event)"
                  field="code"
                  appendTo="body"
                >
                </p-autoComplete>
                </div>

                <div class="form-group col-md-6">
                  <label class="font-weight-bold">{{
                    "Pays" | translate
                  }} *</label
                  >

                  <br />

                  <input
                  formControlName="orderTransportInfoInitialCountry"
                    type="text"
                    class="form-control"
                    disabled="'true'"
                    pInputText
                  />
                </div>

              </div>
            </p-panel>
          </p-scrollPanel>
        </div>
        <div class="p-col-12 p-md-6">
          <p-scrollPanel
            [style]="{ width: '100%', height: 'auto' }"
            styleClass="custombar1"
          >
            <p-panel [toggleable]="true">
              <ng-template pTemplate = "header" >
                <img src="./assets/img/vers.png" width="30px"
                height="30px">          <span style="font-weight: 600">VERS</span>
            </ng-template>



              <div class="row justify-content-around">

                <div class="form-group col-md-6">
                  <label class="font-weight-bold">{{
                    "Ville" | translate
                  }} *</label
                  >
                  <span
                  *ngIf="
                    (orderTransportInfoForm.get('orderTransportInfoFinalCity').touched &&
                    orderTransportInfoForm.get('orderTransportInfoFinalCity').invalid) ||
                    (isFormSubmitted &&
                    orderTransportInfoForm.get('orderTransportInfoFinalCity').invalid)
                  "
                  class="text-lighter"
                  style="color: red; font-size: xx-small"
                >
                  {{ "Obligatoire" | translate }}
                </span>
                  <br />
                  <p-autoComplete
                  formControlName="orderTransportInfoFinalCity"
                  [suggestions]="villeList"
                  (onSelect)="onSelectVilleDistination($event)"
                  (completeMethod)="onVilleSearch($event)"
                  field="code"
                  appendTo="body"
                >
                </p-autoComplete>

                </div>


                <div class="form-group col-md-6">
                  <label class="font-weight-bold">{{
                    "Pays" | translate
                  }} *</label
                  >
                  <span
                  *ngIf="
                    (orderTransportInfoForm.get('orderTransportInfoFinalCountry').touched &&
                    orderTransportInfoForm.get('orderTransportInfoFinalCountry').invalid) ||
                    (isFormSubmitted &&
                    orderTransportInfoForm.get('orderTransportInfoFinalCountry').invalid)
                  "
                  class="text-lighter"
                  style="color: red; font-size: xx-small"
                >
                  {{ "Obligatoire" | translate }}
                </span>
                  <br />
                  <input
                  formControlName="orderTransportInfoFinalCountry"
                    type="text"
                    class="form-control"
                    disabled="'true'"
                    pInputText
                  />
                </div>
              </div>
            </p-panel>
          </p-scrollPanel>
        </div>


      </div> -->


      <div class="row justify-content-around">
        <div class="form-group col-md-6">
          <label class="font-weight-bold">{{
            "Trajet" | translate
          }} *</label
          >
          <span
          *ngIf="
            (orderTransportInfoForm.get('orderTransportInfoTrajet').touched &&
            orderTransportInfoForm.get('orderTransportInfoTrajet').invalid) ||
            (isFormSubmitted &&
            orderTransportInfoForm.get('orderTransportInfoTrajet').invalid)
          "
          class="text-lighter"
          style="color: red; font-size: xx-small"
        >
          {{ "Obligatoire" | translate }}
        </span>
          <br />

          <p-autoComplete
          formControlName="orderTransportInfoTrajet"
          [suggestions]="trajetList"
          (onSelect)="onSelectTrajetSource($event)"
          (completeMethod)="onTrajetSearch($event)"
          field="code"
          appendTo="body"
        >
        </p-autoComplete>
        </div>
        <div class="form-group col-md-3">
          <label class="font-weight-bold">{{
            "Date départ" | translate
          }}</label
          ><br />
        <p-calendar formControlName="orderTransportInfoInitialDate" [showTime]="true" [monthNavigator]="true" [yearNavigator]="true" dateFormat="dd/mm/yy" yearRange="1970:2100"
       >
      </p-calendar>
    </div>
    <div class="form-group col-md-3">
      <label class="font-weight-bold"
        >{{ "Statut" | translate }} *</label
      >
      <input
      formControlName="orderTransportInfoStatus"
        type="text"
        class="form-control"
        disabled="'true'"
        pInputText
      />

    </div>


    </div>

    <div class="row justify-content-around " >


    <div *ngIf="showDialogOrderTransportInfoLine == true">
      <app-order-transport-info-line
      (showDialog)="onHideDialogOrderTransportInfoLine($event)"
      (orderTransportInfoLineAdded)="onLineEditedOrderTransportInfoLine($event)"
       [selectedOrderTransportInfoLine]="selectOrderTransportInfoLine"
       [editMode]="editModeOrderTransportInfoLine"
       [typeInfo]="'Retour'"
    [selectedOrderTransportTrajetQuantity]="selectOrderTransportTrajetQuantity"

      >


      </app-order-transport-info-line>
    </div>
  </div>

      <div class="row justify-content-around " >

        <div class="form-group col-md-6">
          <!-- <p-button  (click)='onShowDialogPackageDetail(null,false)'>Ajouter Details d'emballage</p-button> -->
          <span class="add" style="float: left;">

            <img src="./assets/img/turn.png" style="width: 30px ; height: 30px;">
            <a (click)='onShowDialogOrderTransportInfoLine(null,false)' class="ml-2">Ajouter  Trajet</a></span>
      </div>
      <div class="form-group col-md-6">
      </div>

      <div class="m-2">
      <p-table *ngIf="orderTransportInfoLines.length>0"
        [value]=" this.orderTransportInfoLines" [lazy]="true" [rows]="5" [paginator]="true"
        [totalRecords]="orderTransportInfoLines">
          <ng-template pTemplate="header">
            <tr>
              <th>{{ "Service" | translate }}</th>
              <th>{{ "Ville" | translate }}</th>
              <th>{{ "Nombre Palette /Enlevement " | translate }}</th>
              <th>{{ "Poids /Enlevement" | translate }}</th>
              <th>{{ "Nombre Palette /Livraison " | translate }}</th>
              <th>{{ "Poids /Livraison" | translate }}</th>

              <th style="width: 15%;">{{ "Actions" | translate }}</th>
            </tr>
          </ng-template>
          <ng-template pTemplate="body" let-line>
            <tr>
              <td>{{ line?.orderTransportType?.code }}</td>
              <td>{{ line?.address?.ville?.code }}</td>
            <td>
              {{ line?.numberOfPalletEnlevement  }}
          </td>
          <td>
            {{ line?.weightEnlevement }}
        </td>

        <td>
          {{ line?.numberOfPalletLivraison  }}
      </td>
      <td>
        {{ line?.weightLivraison}}
    </td>

              <td>
                <button

                type="button"
                class="btn btn-sm btn-primary mx-1"
                (click)="onShowDialogOrderTransportInfoLine(line,true)"
                ><!--ADD-->
                <i class="fa fa-pencil"></i>
              </button>
              <button

              type="button"
              class="btn btn-sm btn-danger mx-1"
              (click)="onDeleteOrderTransportInfoLine(line.id)"
              ><!--ADD-->
              <i class="fa fa-trash"></i>
            </button>

              </td>
            </tr>
          </ng-template>

        </p-table>
  </div>

      </div>




    </form>
    </div>

    </div>
    <div class="row pull-left mt-5">
      <button
        type="button"
        pButton
        icon="fa fa-chevron-left"
        (click)="previous()"
      ></button>
    </div>
    <div class="row pull-right mt-5">
      <button
        type="button"
        pButton
        icon="fa fa-chevron-right"
        (click)="next()"
      ></button>
    </div>


      <div *ngIf="showDialogContactAddress == true">
        <app-generate-address-contact
          (showDialog)="onHideDialogGenerateContactAddress($event)"
          (addressContactDeliveryInfo)="affectedContactAddressInfoSelected($event)"
        ></app-generate-address-contact>
      </div>


      <div *ngIf="showDialogPackageDetail == true">
        <app-package-detail
          (showDialog)="onHideDialogPackageDetail($event)"
          (packageDetailAdded)="onLineEditedPackageDetail($event)"
           [selectedPackageDetail]="selectPackageDetail"
           [editMode]="editModePackageDetail"
          ></app-package-detail>
      </div>


